<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>My Blogs on Palenight Blues</title>
        <link>https://rosharp.github.io/posts/</link>
        <description>Recent content in My Blogs on Palenight Blues</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <copyright>&lt;a href=&#34;https://creativecommons.org/licenses/by-nc/4.0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CC BY-NC 4.0&lt;/a&gt;</copyright>
        <lastBuildDate>Thu, 10 Nov 2022 19:49:41 +0500</lastBuildDate>
        <atom:link href="https://rosharp.github.io/posts/index.xml" rel="self" type="application/rss+xml" />
        
        <item>
            <title>Multimonitor setup in bspwm</title>
            <link>https://rosharp.github.io/posts/multiple-monitor-setup-bspwm-&#43;-polybar/</link>
            <pubDate>Thu, 10 Nov 2022 19:49:41 +0500</pubDate>
            
            <guid>https://rosharp.github.io/posts/multiple-monitor-setup-bspwm-&#43;-polybar/</guid>
            <description>Multiple monitor setup - bspwm + Polybar Required packages:
bspwm polybar xrandr autorandr Detect connected displays First of all, we want to check the discriptors of connected displays with this command:
&amp;gt; xrandr --listmonitors Monitors: 2 0: +*eDP1 1920/280x1080/160+0+0 eDP1 1: +HDMI2 1680/470x1050/300+1920+0 HDMI2 Let&amp;rsquo;s remember these; I&amp;rsquo;ll describe my monitors as eDP1 (my laptop&amp;rsquo;s display) and HDMI2 (external monitor).
Startup script Next, we&amp;rsquo;re going to create a script which detects an external monitor when connected, moves bspwm desktops to it and removes those when a monitor is disconnected.</description>
            <content type="html"><![CDATA[<h1 id="multiple-monitor-setup---bspwm--polybar">Multiple monitor setup - bspwm + Polybar</h1>
<p><img src="/Multiple-Monitor-Setup-bspwm-+-Polybar/IMG_0120.PNG" alt="Image"></p>
<p>Required packages:</p>
<ul>
<li>bspwm</li>
<li>polybar</li>
<li>xrandr</li>
<li>autorandr</li>
</ul>
<h2 id="detect-connected-displays">Detect connected displays</h2>
<p>First of all, we want to check the discriptors of connected displays with this command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; xrandr --listmonitors
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Monitors: <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span> 0: +*eDP1 1920/280x1080/160+0+0  eDP1
</span></span><span style="display:flex;"><span> 1: +HDMI2 1680/470x1050/300+1920+0  HDMI2
</span></span></code></pre></div><p>Let&rsquo;s remember these; I&rsquo;ll describe my monitors as eDP1 (my laptop&rsquo;s display) and HDMI2 (external monitor).</p>
<h2 id="startup-script">Startup script</h2>
<p>Next, we&rsquo;re going to create a script which detects an external monitor when connected, moves bspwm desktops to it and removes those when a monitor is disconnected.</p>
<p>You can store it where you like, just make sure to use the correct path to it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#! /bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>internal_monitor<span style="color:#f92672">=</span>eDP1
</span></span><span style="display:flex;"><span>external_monitor<span style="color:#f92672">=</span>HDMI2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> external_monitor <span style="color:#f92672">=</span> *connected* <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    xrandr --output internal_monitor --primary --mode 1920x1080 --rotate normal --output external_monitor --mode 1680x1050 --rotate normal --right-of internal_monitor
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>monitor_add<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	desktops<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span> <span style="color:#75715e"># How many desktops to move to the second monitor</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> desktop in <span style="color:#66d9ef">$(</span>bspc query -D -m $internal_monitor | sed <span style="color:#e6db74">&#34;</span>$desktops<span style="color:#e6db74">&#34;</span>q<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>		bspc desktop $desktop --to-monitor $external_monitor
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Remove &#34;Desktop&#34; created by bspwm</span>
</span></span><span style="display:flex;"><span>  bspc desktop Desktop --remove
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>monitor_remove<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	bspc monitor $internal_monitor -a Desktop <span style="color:#75715e"># Temp desktop because one desktop required per monitor</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Move everything to external monitor to reorder desktops</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> desktop in <span style="color:#66d9ef">$(</span>bspc query -D -m $internal_monitor<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>		bspc desktop $desktop --to-monitor $external_monitor
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e"># Now move everything back to internal monitor</span>
</span></span><span style="display:flex;"><span>	bspc monitor $external_monitor -a Desktop <span style="color:#75715e"># Temp desktop</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> desktop in <span style="color:#66d9ef">$(</span>bspc query -D -m $external_monitor<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>		bspc desktop $desktop --to-monitor $internal_monitor
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	bspc desktop Desktop --remove <span style="color:#75715e"># Remove temp desktops</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#66d9ef">$(</span>xrandr -q | grep <span style="color:#e6db74">&#34;</span>$external_monitor<span style="color:#e6db74"> connected&#34;</span><span style="color:#66d9ef">)</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    monitor_add
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    monitor_remove
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><p>Make it executable:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>chmod +x $HOME/path/to/script/startup
</span></span></code></pre></div><h2 id="bspwm">bspwm</h2>
<p>In <code>bspwmrc</code> add the needed desktop numbers by monitor descriptors like this and add the polybar launch script if you haven&rsquo;t already:</p>
<p>$HOME/.config/bspwm/bspwmrc</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#! /bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>bspc monitor eDP1 -d <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">3</span> <span style="color:#ae81ff">4</span> 
</span></span><span style="display:flex;"><span>bspc monitor HDMI2 -d <span style="color:#ae81ff">5</span> <span style="color:#ae81ff">6</span> <span style="color:#ae81ff">7</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -x $HOME/path/to/polybar/launch.sh <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  $HOME/path/to/polybar/launch.sh &amp;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h2 id="polybar">Polybar</h2>
<p>Let&rsquo;s create a separate Polybar instance for the external monitor.</p>
<p>Pay attention to adding <code>pin-workspaces = true</code> to both main and secondary bars.</p>
<p>$HOME/.config/polybar/config.ini</p>
<pre tabindex="0"><code>[bar/main]
width = 100%
height = 30
offset-y = 0
bottom = false 
fixed-center = true

monitor = eDP1

pin-workspaces = true

...

[bar/external]
width = 100%
height = 30
offset-y = 0
bottom = false 
fixed-center = true

monitor = HDMI2

pin-workspaces = true

...
</code></pre><p>Launch the secondary (external) Polybar instance conditionally when the external monitor is connected. My launch script looks like this:</p>
<p>$HOME/.config/polybar/launch.sh</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>killall polybar
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> pgrep -u $UID -x polybar &gt;/dev/null; <span style="color:#66d9ef">do</span> sleep 1; <span style="color:#66d9ef">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>CONFIG_DIR<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>dirname $0<span style="color:#66d9ef">)</span>/themes/$THEME/config.ini
</span></span><span style="display:flex;"><span>polybar main -c $CONFIG_DIR &amp;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># launch secondary Polybar if an external monitor is connected</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#66d9ef">$(</span>xrandr -q | grep <span style="color:#e6db74">&#39;HDMI2 connected&#39;</span><span style="color:#66d9ef">)</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>  polybar external -c $CONFIG_DIR &amp;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span></code></pre></div><h1 id="autorandr">autorandr</h1>
<p>This command will magically make your external monitor work: it sets the resolution and puts it to the right of your primary display.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>xrandr --output internal_monitor --primary --mode 1920x1080 --rotate normal --output external_monitor --mode 1680x1050 --rotate normal --right-of internal_monitor
</span></span></code></pre></div><p><a href="https://github.com/wertarbyte/autorandr">Autorandr</a> automatically selects a display configuration based on connected devices, so you don&rsquo;t need to use the previous command all the time when connecting a display. Let&rsquo;s create a separate profile with an external display:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>autorandr -s docked
</span></span></code></pre></div><p>Then, you can disconnect your external display and create a profile just for a primary display (I personally don&rsquo;t use it):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>xrandr --output internal_monitor --primary --mode 1920x1080 --rotate normal
</span></span><span style="display:flex;"><span>autorandr -s undocked
</span></span></code></pre></div><p>Finally, create a file called <code>postswitch</code> in the <code>autorandr</code> directory. Put our newly made startup in it in order to run it every time you connect an external display:</p>
<p>$HOME/.config/autorandr/postswitch</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#! /bin/sh
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>$HOME/path/to/script/startup
</span></span></code></pre></div><p>And make it executable:</p>
<p><code>chmod +x $HOME/.config/autorandr/postswitch</code></p>
<p>That&rsquo;s it! Now, you will be able to switch between multiple separate desktops on each display. Everything should work fine after reconnecting an external display - you will still get several new desktops on it.</p>
]]></content>
        </item>
        
        <item>
            <title>Install and patch st</title>
            <link>https://rosharp.github.io/posts/how-to-patch-simple-terminal/</link>
            <pubDate>Wed, 09 Nov 2022 19:30:30 +0500</pubDate>
            
            <guid>https://rosharp.github.io/posts/how-to-patch-simple-terminal/</guid>
            <description>How to install and patch st Patching documentation
Click the download link on the st website at the very bottom and extract (replace the version number):
cd $HOME/Downloads/ tar xvf st-X.X.tar.gz Now, you can build and have a working binary of st (although, very minimal):
cd st-X.X/ make clean install Check out the available patches here. Take the one you need and download with:
curl -O &amp;lt;download link&amp;gt; Apply the patch:</description>
            <content type="html"><![CDATA[<h1 id="how-to-install-and-patch-st">How to install and patch st</h1>
<p><a href="https://suckless.org/hacking/">Patching documentation</a></p>
<p>Click the download link on the <a href="https://st.suckless.org/">st</a> website at the very bottom and extract (replace the version number):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cd $HOME/Downloads/ 
</span></span><span style="display:flex;"><span>tar xvf st-X.X.tar.gz
</span></span></code></pre></div><p>Now, you can build and have a working binary of st (although, very minimal):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>cd st-X.X/
</span></span><span style="display:flex;"><span>make clean install
</span></span></code></pre></div><p>Check out the available patches <a href="https://st.suckless.org/patches/">here</a>. Take the one you need and download with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>curl -O &lt;download link&gt;
</span></span></code></pre></div><p>Apply the patch:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>patch -p1 &lt; path/to/patch.diff
</span></span></code></pre></div><p>And rebuild the binary:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>make clean install
</span></span></code></pre></div><p>Voilà! The patch should be applied.</p>
]]></content>
        </item>
        
    </channel>
</rss>
